<!doctype html>
<html lang="en">
  <head>
  
      <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <link rel="stylesheet" href="https://cdn.rawgit.com/openlayers/openlayers.github.io/master/en/v5.1.3/css/ol.css" type="text/css">
    <style>
      .map {
        height: 700px;
        width: 100%;
      }
	  body {background-color: #b8d8d8;
	  }
	  ul {
    list-style-type: none;
    margin: 0;
    padding: 0;
    overflow: hidden;
    background-color: #4f6367;
}

li {
    float: left;
}

li a {
    display: block;
    color: white;
    text-align: center;
    padding: 14px 16px;
    text-decoration: none;
}

/* Change the link color to #111 (black) on hover */
li a:hover {
    background-color: #7a9e9f;
}
.active {
    background-color: #7a9e9f;
}

    </style>
    <script src="https://cdn.rawgit.com/openlayers/openlayers.github.io/master/en/v5.1.3/build/ol.js"></script>
    <script src="https://code.jquery.com/jquery-1.11.0.min.js"></script>

    <title>DAL Map</title>
  </head>
  <body>
    <h2>Dal MAP</h2>
	<ul>
  <li><a  id="myLink" href="#" onclick="updateMainPage('Map');" class="current" ><img src='map.png' height="42" width="42"/></a></li>
  <li s><a id="myLink" href="#" onclick="updateMap('Hospital');" ><img src='hospital.png' height="42" width="42"/></a></li>
  <li><a id="myLink" href="#" onclick="updateMap('Food');"><img src='food.png' height="42" width="42"/></a></li>
  <li><a id="myLink" href="#"><img src='ambulance.png' height="42" width="42"/></a></li>
    <li><a id="myLink" href="#"><img src='question.png' height="42" width="42"/></a></li>


</ul>

		<!--<input type="button" name="sel" value="الرئيسية" onclick="updateMap('Home')"> -->
	<!--<input type="button" name="sel" value="طعام" onclick="updateMap('Food')">
		<input type="button" name="sel" value="إسعاف" onclick="updateMap('Hospital')">
		<input type="button" name="sel" value="الخريطة" onclick="updateMainPage('Map')">
		-->

	<div id="Wait" style="display: none;">	<img src="Hajj.jpg" alt="Smiley face"  > </div>

    <div id="map" class="map"></div>
    <script type="text/javascript">

      var map = new ol.Map({
        target: 'map',
        layers: [
          new ol.layer.Tile({
            source: new ol.source.OSM(
			/*{url : 'http://mt{0-3}.google.com/vt/lyrs=s&x={x}&y={y}&z={z}'}*/)
          })
        ],
        view: new ol.View({
          center: ol.proj.fromLonLat([ 39.8957164, 21.4139277 ]),
	        	   zoom : 17,
	        	   minZoom : 1       })
      });
	  
      // markers
var sourceFeatures = new ol.source.Vector(),
    layerFeatures = new ol.layer.Vector({source: sourceFeatures});
	 map.addLayer(layerFeatures );
var style1 = [
    new ol.style.Style({
        image: new ol.style.Icon(({
                        scale: 0.2,
            rotateWithView: false,
            anchor: [0.5, 1],
            anchorXUnits: 'fraction',
            anchorYUnits: 'fraction',
            opacity: 1,
            src: 'hospital.png'
        })),
        zIndex: 5
    }),
    new ol.style.Style({
        image: new ol.style.Circle({
            radius: 5,
            fill: new ol.style.Fill({
                color: 'rgba(255,255,255,1)'
            }),
            stroke: new ol.style.Stroke({
                color: 'rgba(0,0,0,1)'
            })
        })
    })
];
var style2 = [
    new ol.style.Style({
        image: new ol.style.Icon(({
            rotateWithView: false,
    anchor: [0.5, 46],
    anchorXUnits: 'fraction',
    anchorYUnits: 'pixels',
            opacity: 1,
                        scale: 0.2,

            src: 'food.png'
        })),
        zIndex: 5
    }),
    new ol.style.Style({
        image: new ol.style.Circle({
            radius: 5,
            fill: new ol.style.Fill({
                color: 'rgba(255,255,255,1)'
            }),
            stroke: new ol.style.Stroke({
                color: 'rgba(0,0,0,1)'
            })
        })
    })
];
var stylequestion = [
    new ol.style.Style({
        image: new ol.style.Icon(({
            rotateWithView: false,
    anchor: [0.5, 46],
    anchorXUnits: 'fraction',
    anchorYUnits: 'pixels',
            opacity: 1,
                        scale: 0.2,

            src: 'food.png'
        })),
        zIndex: 5
    }),
    new ol.style.Style({
        image: new ol.style.Circle({
            radius: 5,
            fill: new ol.style.Fill({
                color: 'rgba(255,255,255,1)'
            }),
            stroke: new ol.style.Stroke({
                color: 'rgba(0,0,0,1)'
            })
        })
    })
];
var feature = new ol.Feature({
    geometry: new ol.geom.Point(ol.proj.fromLonLat([ 39.895179, 21.413789  ]))
	//([ ol.proj.fromLonLat([ 39.8957164, 21.4139277 ])])
});
feature.setStyle(  /*  new ol.style.Style({
        image: new ol.style.Circle({
            radius: 15,
            fill: new ol.style.Fill({
                color: 'red'
            }),
            stroke: new ol.style.Stroke({
                color: 'rgba(0,0,0,1)'
            })
        }),      text: new ol.style.Text({
        font: '12px Calibri,sans-serif',
        fill: new ol.style.Fill({ color: '#000' }),
        stroke: new ol.style.Stroke({
          color: '#fff', width: 2
        }),
        // get the text from the feature - `this` is ol.Feature
        // and show only under certain resolution
        text: 'GPS location'
      })
    },
	
	
	)*/
    new ol.style.Style({
        image: new ol.style.Icon(({
            rotateWithView: false,
    anchor: [0.5, 46],
    anchorXUnits: 'fraction',
    anchorYUnits: 'pixels',
            opacity: 1,
            scale: 0.5,

            src: 'map.png'
        })),
        zIndex: 5
    }),
    new ol.style.Style({
        image: new ol.style.Circle({
            radius: 5,
            fill: new ol.style.Fill({
                color: 'rgba(255,255,255,1)'
            }),
            stroke: new ol.style.Stroke({
                color: 'rgba(0,0,0,1)'
            })
        })
    }));
sourceFeatures.addFeature(feature);

			
//Hospital			
var feature2 = new ol.Feature({
	name:"Hospital",
    geometry: new ol.geom.Point(ol.proj.fromLonLat([ 39.8947164, 21.414053 ]))
	//([ ol.proj.fromLonLat([ 39.8957164, 21.4139277 ])])
});
feature2.setStyle( style1);
sourceFeatures.addFeature(feature2);
var hospital2 = new ol.Feature({
	name:"Hospital2",
    geometry: new ol.geom.Point(ol.proj.fromLonLat([  39.894122, 21.413492 ]))
	//([ ol.proj.fromLonLat([ 39.8957164, 21.4139277 ])])
});
hospital2.setStyle( style1);
sourceFeatures.addFeature(hospital2);

var feature3 = new ol.Feature({
	name:"ambulance",
    geometry: new ol.geom.Point(ol.proj.fromLonLat([ 39.894713, 21.413653 ]))
	//([ ol.proj.fromLonLat([ 39.8957164, 21.4139277 ])])
});
feature3.setStyle( stylequestion);
sourceFeatures.addFeature(feature3);

var food2 = new ol.Feature({
    geometry: new ol.geom.Point(ol.proj.fromLonLat([ 39.895028, 21.413562]))
	//([ ol.proj.fromLonLat([ 39.8957164, 21.4139277 ])])
});
food2.setStyle( style2);
sourceFeatures.addFeature(food2);

var food3 = new ol.Feature({
    geometry: new ol.geom.Point(ol.proj.fromLonLat([ 39.894321, 21.413874]))
	//([ ol.proj.fromLonLat([ 39.8957164, 21.4139277 ])])
});
food3.setStyle( style2);
sourceFeatures.addFeature(food3)

// focus on the feature
var ext = feature.getGeometry().getExtent();

//map.getView().fitExtent(vectorSources.getExtent(), map.getSize());
map.getView().fit(sourceFeatures.getExtent(), map.getSize());
map.getView().setZoom(19);

///////////////////////////////////

var points = [[ 39.8947164, 21.414053 ],[ 39.895179, 21.413789  ]];

for (var i = 0; i < points.length; i++) {
    points[i] = ol.proj.transform(points[i], 'EPSG:4326', 'EPSG:3857');
}

var featureLine = new ol.Feature({
    geometry: new ol.geom.LineString(points)
});

featureLine.setStyle(new ol.style.Style({}));

sourceFeatures.addFeature(featureLine);

//
var foodpoints = [[39.895028, 21.413562],[ 39.895179, 21.413789  ]];
for (var i = 0; i < foodpoints.length; i++) {
    foodpoints[i] = ol.proj.transform(foodpoints[i], 'EPSG:4326', 'EPSG:3857');
}
var foodLine = new ol.Feature({
    geometry: new ol.geom.LineString(foodpoints)
});

foodLine.setStyle(new ol.style.Style({}) );

sourceFeatures.addFeature(foodLine);
//

var flickrSource = new ol.source.Vector();
function flickrStyle(feature) {
      var style = new ol.style.Style({
        image: new ol.style.Circle({
          radius: 6,
          stroke: new ol.style.Stroke({
            color: 'white',
            width: 2
          }),
          fill: new ol.style.Fill({
            color: 'green'
          })
        })
      });
      return [style];
    }

    var flickrLayer = new ol.layer.Vector({
      source: flickrSource,
      style: flickrStyle
    });
    map.addLayer(flickrLayer );

    // when jQuery has loaded the data, we can create features for each photo
    function successHandler(data) {
      // we need to transform the geometries into the view's projection
      var transform = ol.proj.getTransform('EPSG:4326', 'EPSG:3857');
      // loop over the items in the response
      data.items.forEach(function(item) {
        // create a new feature with the item as the properties
        var feature = new ol.Feature(item);
        // add a url property for later ease of access
        feature.set('url', item.media.m);
        // create an appropriate geometry and add it to the feature
        var coordinate = transform([parseFloat(item.longitude), parseFloat(item.latitude)]);
        var geometry = new ol.geom.Point(coordinate);
        feature.setGeometry(geometry);
        // add the feature to the source
        flickrSource.addFeature(feature);
      });
    }

    $.ajax({
      url: 'jsonJarirFeed',
      dataType: 'jsonp',
      jsonpCallback: 'data/jsonJarirFeed',
      success: successHandler
    });


///////////////////////////////
// set mode to current mode of double clicked feature                       
map.on('click', function(evt) {
  var feature = map.forEachFeatureAtPixel(evt.pixel,
    function(feature, layer) {	
	if(feature.get('name') == 'ambulance2'){
document.getElementById("map").style.display = 'none'; 
document.getElementById("Wait").style.display = 'block'; 
}

    });

}); 

function updateMap(value){
if (value == 'Food'){
feature3.setStyle(new ol.style.Style({}));
food2.setStyle( style2);
food3.setStyle(new ol.style.Style({}));


feature2.setStyle(new ol.style.Style({}));
hospital2.setStyle(new ol.style.Style({}));

featureLine.setStyle(new ol.style.Style({}));
foodLine.setStyle(new ol.style.Style({
        fill: new ol.style.Fill({ color: '#fe5f55', weight: 6 }),
        stroke: new ol.style.Stroke({ color: '#fe5f55', width: 5 })
    }));

}
else if (value == 'Hospital'){
hospital2.setStyle(new ol.style.Style({}));
feature3.setStyle(new ol.style.Style({}));
feature2.setStyle(style1);
food2.setStyle(new ol.style.Style({}));

food3.setStyle(new ol.style.Style({}));

featureLine.setStyle(new ol.style.Style({
        fill: new ol.style.Fill({ color: '#fe5f55', weight: 6 }),
        stroke: new ol.style.Stroke({ color: '#fe5f55', width: 5 })
    }));
foodLine.setStyle(new ol.style.Style({}));


}
if (value == 'Home'){
feature2.setStyle(style1);
hospital2.setStyle(style1);

feature3.setStyle( stylequestion);
food2.setStyle(style2);
food3.setStyle(style2);

featureLine.setStyle(new ol.style.Style({}));
foodLine.setStyle(new ol.style.Style({}));

}
}
function updateMainPage(value){
if (value == 'Map'){
document.getElementById("map").style.display = 'block'; 
document.getElementById("Wait").style.display = 'none'; 

feature3.setStyle( stylequestion);
food2.setStyle(style2);
food3.setStyle(style2);
foodLine.setStyle(new ol.style.Style({}));

feature2.setStyle(style1);
hospital2.setStyle(style1);
featureLine.setStyle(new ol.style.Style({}));


}

}

jsonJarirFeed({
		"title": "Recent Uploads tagged bird, with geodata",
		"link": "http://www.flickr.com/photos/tags/bird/",
		"description": "",
		"modified": "2014-08-22T01:08:29Z",
		"generator": "http://www.flickr.com/",
		"items":[
	{
		"Pid": "521183",
		"name": "هيتاشي ،LD65HTS02UCO ،دقة 4K الترا اتش دي ،ال اي دي ،تلفزيون ذكي ،65 بوصة ،أسود",
		"Cost": "2599",
		"category": "التلفزيون الذكي",
		"latitude": "46.775328999999999",
		"longitude": "24.722090999999999"
	},
	{
		"Pid": "512602",
		"name": "سكاي وورث ،49E2000S ،فل اتش دي ،ال اي دي ،تلفزيون ذكي ،49 بوصة ،أسود",
		"Cost": "1099",
		"category": "التلفزيون الذكي",
		"latitude": "46.775328999999999",
		"longitude": "24.722090999999999"
	},
	{
		"Pid": "512995",
		"name": "تي سي ال ،55C2US Pro ،دقة 4K الترا اتش دي ،تلفزيون ذكي ،55 بوصة ،فضي",
		"Cost": "1999",
		"category": "التلفزيون الذكي",
		"latitude": "46.775328999999999",
		"longitude": "24.722090999999999"
	},
	{
		"Pid": "518687",
		"name": "سكاي وورث ،65G6 ،دقة 4K الترا اتش دي ،ال اي دي ،تلفزيون ذكي ،65 بوصة ،أسود",
		"Cost": "2899",
		"category": "التلفزيون الذكي",
		"latitude": "46.775328999999999",
		"longitude": "24.722090999999999"
	},
	{
		"Pid": "521908",
		"name": "سكاي وورث ،65Q3C ،دقة 4K الترا اتش دي ،DLED ،تلفزيون ذكي ،65 بوصة ،أسود",
		"Cost": "3199",
		"category": "التلفزيون الذكي",
		"latitude": "46.775328999999999",
		"longitude": "24.722090999999999"
	},
	{
		"Pid": "517032",
		"name": "هيتاشي ،LD65CHS01U ،دقة 4K الترا اتش دي ،ال اي دي ،تلفزيون ذكي ،65 بوصة ،أسود",
		"Cost": "2949",
		"category": "التلفزيون الذكي",
		"latitude": "46.775328999999999",
		"longitude": "24.722090999999999"
	},
	{
		"Pid": "518558",
		"name": "ال جي ،75UK7050PVA ،دقة 4K الترا اتش دي ،ال اي دي ،تلفزيون ذكي ،75 بوصة ،أسود",
		"Cost": "6999",
		"category": "التلفزيون الذكي",
		"latitude": "46.775328999999999",
		"longitude": "24.722090999999999"
	},
	{
		"Pid": "518663",
		"name": "هيتاشي ،LD86CHS03U ،دقة 4K الترا اتش دي ،ال اي دي ،تلفزيون ذكي ،86",
		"Cost": "9699",
		"category": "التلفزيون الذكي",
		"latitude": "46.775328999999999",
		"longitude": "24.722090999999999"
	},
	{
		"Pid": "518653",
		"name": "هيتاشي ،LD75HTS02UCO ،دقة 4K الترا اتش دي ،ال اي دي ،تلفزيون ذكي ،75 بوصة ،أسود",
		"Cost": "4999",
		"category": "التلفزيون الذكي",
		"latitude": "46.775328999999999",
		"longitude": "24.722090999999999"
	},
	{
		"Pid": "508435",
		"name": "ال جي ،65UK6400PVC ،دقة 4K الترا اتش دي ،تلفزيون ذكي ،65 بوصة ،أسود دقيق",
		"Cost": "3799",
		"category": "التلفزيون الذكي",
		"latitude": "46.775328999999999",
		"longitude": "24.722090999999999"
	},
	{
		"Pid": "526273",
		"name": "سكاي وورث ،75G6B ،دقة 4K الترا اتش دي ،ال اي دي ،تلفزيون ذكي ،75 بوصة ،Light Champagne",
		"Cost": "4999",
		"category": "التلفزيون الذكي",
		"latitude": "46.775328999999999",
		"longitude": "24.722090999999999"
	},
	{
		"Pid": "508341",
		"name": "سامسونج ،NU7100 ،دقة 4K الترا اتش دي ،تلفزيون ذكي ،55 بوصة ،أسود فحمي",
		"Cost": "2399",
		"category": "التلفزيون الذكي",
		"latitude": "46.775328999999999",
		"longitude": "24.722090999999999"
	},
	{
		"Pid": "522754",
		"name": "سامسونج ،NU7100 ،دقة 4K الترا اتش دي ،ال اي دي ،تلفزيون ذكي ،65 بوصة ،أسود فحمي",
		"Cost": "3899",
		"category": "التلفزيون الذكي",
		"latitude": "46.775328999999999",
		"longitude": "24.722090999999999"
	},
	{
		"Pid": "518683",
		"name": "سكاي وورث ،65U2 ،دقة 4K الترا اتش دي ،ال اي دي ،تلفزيون ذكي ،65 بوصة ،أسود",
		"Cost": "2399",
		"category": "التلفزيون الذكي",
		"latitude": "46.775328999999999",
		"longitude": "24.722090999999999"
	},
	{
		"Pid": "512994",
		"name": "تي سي ال ،55P6US ،دقة 4K الترا اتش دي ،تلفزيون ذكي ،55 بوصة ،فضي",
		"Cost": "1599",
		"category": "التلفزيون الذكي",
		"latitude": "46.775328999999999",
		"longitude": "24.722090999999999"
	},
	{
		"Pid": "508436",
		"name": "ال جي ،55UK6400PVC ،دقة 4K الترا اتش دي ،تلفزيون ذكي ،55 بوصة ،أسود",
		"Cost": "2399",
		"category": "التلفزيون الذكي",
		"latitude": "46.775328999999999",
		"longitude": "24.722090999999999"
	},
	{
		"Pid": "508407",
		"name": "ال جي ،49UK6300PVB ،دقة 4K الترا اتش دي ،تلفزيون ذكي ،49 بوصة ،أسود",
		"Cost": "1899",
		"category": "التلفزيون الذكي",
		"latitude": "46.775328999999999",
		"longitude": "24.722090999999999"
	},
	{
		"Pid": "522747",
		"name": "سامسونج ،N5300 ،فل اتش دي ،ال اي دي ،تلفزيون ذكي ،49 بوصة ،أسود فحمي",
		"Cost": "1699",
		"category": "التلفزيون الذكي",
		"latitude": "46.775328999999999",
		"longitude": "24.722090999999999"
	},
	{
		"Pid": "517030",
		"name": "هيتاشي ،LD55CHS01U ،دقة 4K الترا اتش دي ،ال اي دي ،تلفزيون ذكي ،55 بوصة ،أسود",
		"Cost": "1599",
		"category": "التلفزيون الذكي",
		"latitude": "46.775328999999999",
		"longitude": "24.722090999999999"
	},
	{
		"Pid": "516986",
		"name": "هيتاشي ،LD49HTS01 ،دقة 4K الترا اتش دي ،ال اي دي ،تلفزيون ذكي ،49 بوصة ،أسود",
		"Cost": "1349",
		"category": "التلفزيون الذكي",
		"latitude": "46.775328999999999",
		"longitude": "24.722090999999999"
	},
	{
		"Pid": ""
	}
]
})


    </script>
  </body>
</html>
